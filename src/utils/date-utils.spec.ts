import { isPaymentWeekComplete } from './date-utils';

process.env.TZ = 'UTC';

describe('date-utils', () => {
  describe('isPaymentWeekComplete', () => {
    it('Should be complete when input date is wednesday and today is friday in the same week', /**
     * Requirement: {@link https://github.com/RJ-SMTR/api-cct/issues/177#issuecomment-1934531824 Issue #177, item 2 - GitHub}
     *
     * Expected logic:
     * ```
     * Input date           a Today date           b
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ February      2023 ║ ║ February      2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  |01│02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗──┼──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08║09║10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     *
     * Payment week         c Payment compete in   d
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ Febuary       2023 ║ ║ Febuary       2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──╔══╗──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  ║01║02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗══╝──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08║09║10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     * ```
     */ () => {
      // Arrange
      jest
        .spyOn(global.Date, 'now')
        .mockImplementation(() => new Date('2024-02-09').valueOf());

      // Act
      const isComplete = isPaymentWeekComplete(new Date('2024-02-07'));

      // Assert
      expect(isComplete).toBeTruthy();
    });

    it('Should be complete when input date is wednesday and today is any day in the future week', /**
     * Requirement: {@link https://github.com/RJ-SMTR/api-cct/issues/177#issuecomment-1934531824 Issue #177, item 2 - GitHub}
     *
     * Expected logic:
     * ```
     * Input date           a Today date           b
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ February      2023 ║ ║ February      2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  |01│02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08│09│10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──╔══╗──┼──┼──┼──┼──╢
     * ║11│12│13│14│15│16│17║ ║11║12║13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──╚══╝──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     *
     * Payment week         c Payment compete in   d
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ Febuary       2023 ║ ║ Febuary       2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──╔══╗──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  ║01║02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗══╝──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08║09║10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     * ```
     */ () => {
      // Arrange
      jest
        .spyOn(global.Date, 'now')
        .mockImplementation(() => new Date('2024-02-12').valueOf());

      // Act
      const isComplete = isPaymentWeekComplete(new Date('2024-02-07'));

      // Assert
      expect(isComplete).toBeTruthy();
    });

    it('Should not be complete when input date is wednesday and today is thursday in the same week', /**
     * Requirement: {@link https://github.com/RJ-SMTR/api-cct/issues/177#issuecomment-1934531824 Issue #177, item 3 - GitHub}
     *
     * Expected logic:
     * ```
     * Input date           a Today date           b
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ February      2023 ║ ║ February      2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  |01│02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗──┼──┼──╢ ╟──┼──┼──┼──╔══╗──┼──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07║08║09│10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──╚══╝──┼──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     *
     * Payment week         c Payment compete in   d
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ Febuary       2023 ║ ║ Febuary       2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──╔══╗──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  ║01║02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗══╝──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08║09║10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     * ```
     */ () => {
      // Arrange
      jest
        .spyOn(global.Date, 'now')
        .mockImplementation(() => new Date('2024-02-08').valueOf());

      // Act
      const isComplete = isPaymentWeekComplete(new Date('2024-02-07'));

      // Assert
      expect(isComplete).toBeFalsy();
    });

    it('Should not be complete when input date is wednesday and today is any day before friday of the same week', /**
     * Requirement: {@link https://github.com/RJ-SMTR/api-cct/issues/177#issuecomment-1934531824 Issue #177, item 3 - GitHub}
     *
     * Expected logic:
     * ```
     * Input date           a Today date           b
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ February      2023 ║ ║ February      2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║  |  |  |  |01│02│03║ ║  |  |  |  |01║02║03║
     * ╟──┼──┼──╔══╗──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08│09│10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──╔══╗──┼──┼──┼──┼──╢
     * ║11│12│13│14│15│16│17║ ║11║12║13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──╚══╝──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     *
     * Payment week         c Payment compete in   d
     * ╔════════════════════╗ ╔════════════════════╗
     * ║ Febuary       2023 ║ ║ Febuary       2023 ║
     * ╟──┬──┬──┬──┬──┬──┬──╢ ╟──┬──┬──┬──┬──┬──┬──╢
     * ║Su│Mo│Tu│We│Th│Fr│Sa║ ║Su│Mo│Tu│We│Th│Fr│Sa║
     * ╟──┼──┼──┼──╔══╗──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║  |  |  |  ║01║02│03║ ║  |  |  |  |01│02│03║
     * ╟──┼──┼──╔══╗══╝──┼──╢ ╟──┼──┼──┼──┼──╔══╗──╢
     * ║04│05│06║07║08│09│10║ ║04│05│06│07│08║09║10║
     * ╟──┼──┼──╚══╝──┼──┼──╢ ╟──┼──┼──┼──┼──╚══╝──╢
     * ║11│12│13│14│15│16│17║ ║11│12│13│14│15│16│17║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║18│19│20│21│22│23│24║ ║18│19│20│21│22│23│24║
     * ╟──┼──┼──┼──┼──┼──┼──╢ ╟──┼──┼──┼──┼──┼──┼──╢
     * ║25│26│27|28|29|  |  ║ ║25│26│27|28|29|  |  ║
     * ╚══╧══╧══╧══╧══╧══╧══╝ ╚══╧══╧══╧══╧══╧══╧══╝
     * ```
     */ () => {
      // Arrange
      jest
        .spyOn(global.Date, 'now')
        .mockImplementation(() => new Date('2024-02-02').valueOf());

      // Act
      const isComplete = isPaymentWeekComplete(new Date('2024-02-07'));

      // Assert
      expect(isComplete).toBeFalsy();
    });
  });
});
